---
---
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Harness</title>
    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/layout.css"></link>

    <script src="https://unpkg.com/js-yaml@3.12.0/dist/js-yaml.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@10.0.0/dist/markdown-it.min.js"></script>
    <script src="https://unpkg.com/turndown@7.0.0/dist/turndown.js"></script>    

    <script src="https://unpkg.com/@isomorphic-git/lightning-fs"></script>
    <script src="https://unpkg.com/isomorphic-git@beta"></script>

    <script type="module">     
     import { EleventyEditor  } from '/assets/js/editor.js';
     
     const runDisplay = async (e) => {
	 let editor = new EleventyEditor(document.querySelector( e.target.getAttribute('data-for') ).value, {
	     corsProxy: 'http://localhost:9999'
	 });
	 
	 await editor.clone();
	 
	 window.addEventListener('hashchange', function() { editor.display() }, false);
	 
	 editor.display();	 
     };
     
     let cloneButton = document.querySelector('#clone');

     cloneButton.addEventListener('click', runDisplay, false);
     runDisplay( { target: cloneButton } );
    </script>
  </head>

  <body>
    <header>
      <h1>Editor</h1>
    </header>
    <details open="true">
	<summary>Directory listing</summary>
	<input id="repository" type="text" name="repository" value="https://github.com/jamesaduncan/osom.guide.git">
	<button data-for="#repository" id="clone">Edit</button>
	<section id="listing">
	</section>
    </details>
    <details>
      <summary>Document metadata</summary>
      <section id="metadata">
      </section>
    </details>
    <details class="editor" open="true">
      <summary></summary>
      <section id="editor" contentEditable="true"></section>
    </details>
    <footer>
      <span class="copyright">Copyright 2021 Stance Global Ltd</span>
    </footer>
  </body>
</html>
